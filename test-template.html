<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Diagnostic Vertex</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // FONCTION DE DEBUGAGE
        function logDebug(msg, color = "white") {
            const status = document.getElementById('debug-status');
            if(status) status.innerHTML += `<p style="color:${color}">> ${msg}</p>`;
            console.log(msg);
        }

        window.onerror = function(msg, url, line) {
            logDebug(`ERREUR JS: ${msg} (Ligne ${line})`, "#f87171");
        };

        const version = new Date().getTime();
        const params = new URLSearchParams(window.location.search);
        const produitId = params.get('id');

        window.onload = () => {
            logDebug("Démarrage du diagnostic...");
            if(!produitId) {
                logDebug("ERREUR: Aucun ID de produit dans l'URL (?id=...)", "#f87171");
                return;
            }
            logDebug(`ID détecté: ${produitId}`);
            
            // Chargement Config
            const cScript = document.createElement('script');
            cScript.src = "config.js?v=" + version;
            cScript.onload = () => logDebug("✅ Fichier config.js chargé", "#4ad361");
            cScript.onerror = () => logDebug("❌ ÉCHEC: config.js introuvable", "#f87171");
            document.head.appendChild(cScript);

            // Chargement Produit
            const pScript = document.createElement('script');
            pScript.src = "produits/" + produitId + ".js?v=" + version;
            pScript.onload = () => {
                logDebug(`✅ Fichier produits/${produitId}.js chargé`, "#4ad361");
                setTimeout(checkData, 500);
            };
            pScript.onerror = () => logDebug(`❌ ÉCHEC: produits/${produitId}.js introuvable`, "#f87171");
            document.head.appendChild(pScript);
        };

        function checkData() {
            if (window.PRODUCT_DATA) {
                logDebug("✅ Données PRODUCT_DATA trouvées !", "#4ad361");
                logDebug("Lancement de l'affichage...");
                window.PRODUCT_CONFIG = window.PRODUCT_DATA;
                initApp();
            } else {
                logDebug("❌ ERREUR: PRODUCT_DATA est vide. Vérifiez la 1ère ligne de votre fichier .js", "#f87171");
            }
        }
    </script>
    <style>
        body { background: #020617; color: white; font-family: monospace; }
        #main-card { display: none; } /* Caché pendant le debug */
        #debug-console { padding: 40px; max-width: 800px; margin: auto; }
    </style>
</head>
<body>
    <div id="debug-console" class="mt-10 bg-black/50 border border-white/10 rounded-xl p-6">
        <h1 class="text-[#FFD700] font-bold mb-4 uppercase tracking-widest">Console de Diagnostic Vertex</h1>
        <div id="debug-status" class="space-y-2 text-sm"></div>
        <div class="mt-8 p-4 bg-blue-900/20 border border-blue-500/30 text-blue-200 text-xs italic">
            Si tout est vert et que ça reste bloqué ici, le problème vient du script d'affichage (initApp).
        </div>
    </div>

    <div id="main-card">
        </div>

    <script>
        function initApp() {
            // Affiche la carte et cache la console
            document.getElementById('debug-console').style.display = 'none';
            document.getElementById('main-card').style.display = 'block';
            document.body.style.opacity = "1";
            
            // ICI: Remets le code de la fonction initApp() que je t'ai donné avant
            // ... (je ne le remets pas pour ne pas surcharger, mais il est nécessaire)
        }
    </script>
</body>
</html>
