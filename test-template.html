<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="images/logo-vertex.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertex Monaco - Fiche Technique</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;900&display=swap');
        html { scroll-behavior: smooth; }
        body { background: #020617; color: white; font-family: 'Outfit', sans-serif; overflow-x: hidden; -webkit-font-smoothing: antialiased; }
        #main-card { display: none; opacity: 0; transition: opacity 0.8s ease-in-out; }
        
        /* Menu de sélection d'impression (Interface) */
        #print-options-panel {
            position: fixed;
            bottom: 90px;
            right: 24px;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 1.5rem;
            border-radius: 1.5rem;
            z-index: 100;
            display: none;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            width: 250px;
        }

        /* 3D Effects */
        .scene-3d { perspective: 1200px; display: flex; align-items: center; justify-content: center; min-height: 250px; width: 100%; }
        .screen-3d { position: relative; transform-style: preserve-3d; transform: rotateY(-15deg) rotateX(5deg); transition: transform 0.5s ease; }
        .face-front { width: 100%; height: 100%; transform: translateZ(10px); background: linear-gradient(135deg, #1e293b 0%, #020617 100%); display: flex; align-items: center; justify-content: center; border: 1px solid rgba(255,215,0,0.3); }

        @media print {
            @page { size: A4 portrait; margin: 15mm 15mm; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            
            /* Masquage des éléments inutiles */
            #btn-print, #btn-back, #lang-switcher, #admin-ui, #print-options-panel, .btn-settings, .admin-overlay { 
                display: none !important; 
            }

            body { background: white !important; color: #1a1a1a !important; padding: 0 !important; }
            #main-card { display: block !important; opacity: 1 !important; border: none !important; background: white !important; box-shadow: none !important; width: 100% !important; max-width: 100% !important; }
            
            header { border-bottom: 3px solid #FFD700 !important; margin-bottom: 10mm !important; padding-bottom: 5mm !important; page-break-after: avoid; }
            
            /* Layout vertical non-compact */
            .print-grid-2cols, .print-grid-specs, .print-section-flex { 
                display: flex !important; 
                flex-direction: column !important; 
                gap: 15mm !important; 
            }

            .print-col-left, .print-col-right, .print-sidebar, #ui-specs { 
                width: 100% !important; 
            }

            /* Espacement des blocs */
            section, .print-col-right, .print-sidebar { 
                page-break-inside: avoid !important; 
                margin-top: 10mm !important;
                background: #fdfdfd !important;
                border: 1px solid #eee !important;
                padding: 8mm !important;
                border-radius: 5mm !important;
            }

            /* Masquage dynamique des sections */
            .hide-section { display: none !important; }
        }
    </style>
</head>
<body class="p-2 md:p-8">

    <div class="fixed top-4 left-4 md:top-8 md:left-8 z-50 flex gap-2">
        <a id="btn-back" href="#" class="bg-white/10 backdrop-blur-md border border-white/10 text-white p-3 md:px-5 md:py-3 rounded-full flex items-center gap-2 font-bold uppercase text-[10px] hover:bg-[#FFD700] hover:text-black transition-all">
            <i data-lucide="arrow-left" class="w-4 h-4"></i> <span id="txt-showroom"></span>
        </a>
    </div>

    <div id="lang-switcher" class="fixed top-4 right-4 z-50 flex bg-white/10 backdrop-blur-md rounded-full p-1 border border-white/10">
        <button onclick="changeLang('fr')" id="lang-fr" class="px-3 py-1 rounded-full text-[10px] font-bold transition-all">FR</button>
        <button onclick="changeLang('en')" id="lang-en" class="px-3 py-1 rounded-full text-[10px] font-bold transition-all">EN</button>
    </div>

    <div id="print-options-panel">
        <h4 class="text-[#FFD700] font-black text-[11px] uppercase tracking-widest mb-4 flex items-center gap-2">
            <i data-lucide="sliders-horizontal" class="w-4 h-4"></i> Impression
        </h4>
        <div class="space-y-3 text-white/80 text-[11px] font-medium">
            <label class="flex items-center gap-3 cursor-pointer hover:text-white"><input type="checkbox" checked onchange="toggleSection('print-media', this)" class="accent-[#FFD700]"> Galerie Photos</label>
            <label class="flex items-center gap-3 cursor-pointer hover:text-white"><input type="checkbox" checked onchange="toggleSection('print-3d', this)" class="accent-[#FFD700]"> Dimensions & VESA</label>
            <label class="flex items-center gap-3 cursor-pointer hover:text-white"><input type="checkbox" checked onchange="toggleSection('print-inclus', this)" class="accent-[#FFD700]"> Inclus & Options</label>
            <label class="flex items-center gap-3 cursor-pointer hover:text-white"><input type="checkbox" checked onchange="toggleSection('print-specs', this)" class="accent-[#FFD700]"> Fiche Technique</label>
            <label class="flex items-center gap-3 cursor-pointer hover:text-white"><input type="checkbox" checked onchange="toggleSection('print-sidebar', this)" class="accent-[#FFD700]"> Expert & Entretien</label>
        </div>
    </div>

    <button onclick="togglePanel()" class="btn-settings fixed bottom-24 right-6 z-50 bg-slate-800 text-white p-4 rounded-full shadow-2xl border border-white/20 hover:bg-slate-700 transition-all">
        <i data-lucide="settings-2" class="w-5 h-5"></i>
    </button>

    <button id="btn-print" onclick="window.print()" class="fixed bottom-6 right-6 z-50 bg-[#FFD700] text-black p-4 rounded-full shadow-2xl hover:scale-110 transition-transform flex items-center gap-2 font-bold uppercase text-[10px]">
        <i data-lucide="printer" class="w-4 h-4"></i> <span id="txt-print"></span>
    </button>

    <div id="main-card" class="max-w-6xl mx-auto border border-white/5 rounded-[3rem] overflow-hidden bg-slate-900/50 backdrop-blur-xl shadow-2xl">
        
        <header class="p-8 md:p-14 border-b border-white/5 flex flex-col md:flex-row justify-between items-center gap-8">
            <div class="flex-1">
                <p id="ui-brand" class="font-bold uppercase tracking-[0.4em] text-[11px] mb-4 text-[#FFD700]"></p>
                <h1 id="ui-titre" class="text-3xl md:text-7xl font-black uppercase tracking-tighter italic leading-tight mb-6"></h1>
                <div id="ui-badges" class="flex flex-wrap gap-3"></div>
            </div>
            <img id="ui-logo" src="" class="h-12 md:h-16 object-contain">
        </header>

        <div class="print-grid-2cols grid lg:grid-cols-2 gap-8 p-6 md:p-10">
            <div id="print-media" class="print-col-left space-y-6">
                <div class="bg-black/30 rounded-[2rem] p-6 border border-white/5 flex items-center justify-center min-h-[300px] md:min-h-[450px]">
                    <img id="ui-main-img" src="" class="max-w-full max-h-[350px] object-contain drop-shadow-2xl">
                </div>
                <div id="ui-galerie" class="grid grid-cols-3 gap-4"></div>
            </div>

            <div id="print-3d" class="print-col-right bg-white/[0.03] rounded-[2rem] p-6 border border-white/5 flex flex-col items-center justify-center">
                <div class="scene-3d">
                    <div id="ui-3d" class="screen-3d">
                        <div class="face-front rounded-sm"><span id="val-diag" class="font-black italic text-[#FFD700] text-xl md:text-3xl"></span></div>
                        <div class="absolute -top-10 left-0 right-0 border-t border-dashed border-[#FFD700]/40 flex justify-center pt-2 text-[#FFD700] text-[9px] font-bold" id="val-w"></div>
                        <div class="absolute -left-12 top-0 bottom-0 border-l border-dashed border-[#FFD700]/40 flex items-center text-[#FFD700] text-[9px] font-bold"><span id="val-h" class="-rotate-90 whitespace-nowrap"></span></div>
                    </div>
                </div>
                <div class="mt-8 bg-black/50 p-5 rounded-2xl border border-[#FFD700]/20 w-full">
                    <p id="txt-fixation" class="text-[8px] uppercase text-slate-500 font-black mb-1"></p>
                    <p id="val-vesa" class="text-xs md:text-sm font-black text-[#FFD700] uppercase"></p>
                </div>
            </div>
        </div>

        <section id="print-inclus" class="py-10 px-6 md:px-10 border-y border-white/5 bg-white/[0.01]">
            <div class="print-section-flex flex flex-col md:flex-row gap-16">
                <div class="flex-1">
                    <h3 id="txt-inclus-title" class="text-[#FFD700] font-black text-[10px] uppercase mb-8 flex items-center gap-3"></h3>
                    <div id="ui-acc" class="grid grid-cols-1 sm:grid-cols-2 gap-6"></div>
                </div>
                <div class="flex-1">
                    <h3 id="txt-options-title" class="text-[#FFD700] font-black text-[10px] uppercase mb-8 flex items-center gap-3"></h3>
                    <div id="ui-opt" class="grid grid-cols-1 sm:grid-cols-2 gap-3"></div>
                </div>
            </div>
        </section>

        <div class="print-grid-specs p-6 md:p-10 grid lg:grid-cols-3 gap-8">
            <div id="print-specs" class="lg:col-span-2 grid md:grid-cols-2 gap-8">
                <div id="ui-specs" class="contents"></div>
            </div>
            <div id="print-sidebar" class="print-sidebar space-y-6">
                <div class="bg-white/[0.03] p-8 rounded-[2rem] border-l-4 border-[#FFD700]">
                    <h3 id="txt-expert-title" class="font-black uppercase text-[10px] mb-8 text-[#FFD700]"></h3>
                    <div id="ui-team" class="space-y-6"></div>
                </div>
                <div class="bg-black/20 p-8 rounded-[2rem] border border-white/5">
                    <h3 id="txt-entretien-title" class="text-[#FFD700] font-black uppercase text-[10px] mb-6"></h3>
                    <ul id="ui-entret-list" class="space-y-3 text-[9px] text-slate-400 italic"></ul>
                </div>
            </div>
        </div>

        <footer class="p-10 border-t border-white/5 flex justify-between items-center text-[9px] text-slate-500 font-bold uppercase">
            <p id="ui-addr"></p>
            <div class="flex gap-8 text-white"><p id="ui-ref"></p><p id="ui-sn" class="opacity-30"></p></div>
        </footer>
    </div>

    <script>
        const REPO_OWNER = "sarlvertex", REPO_NAME = "fiches-techniques";
        const params = new URLSearchParams(window.location.search);
        const produitId = params.get('id'), dossier = params.get('dir') || 'produits', currentLang = params.get('lang') || 'fr';

        const UI_STRINGS = {
            fr: { showroom: "Retour Showroom", print: "Imprimer la Fiche", fixation: "Système de Fixation", inclus: "Inclus dans le Pack", options: "Options Disponibles", expert: "Votre Expert", entretien: "Entretien" },
            en: { showroom: "Back to Showroom", print: "Print Datasheet", fixation: "Mounting System", inclus: "Included", options: "Available Options", expert: "Your Expert", entretien: "Maintenance" }
        };

        function togglePanel() {
            const panel = document.getElementById('print-options-panel');
            panel.style.display = (panel.style.display === 'block') ? 'none' : 'block';
        }

        function toggleSection(id, cb) {
            document.getElementById(id).classList.toggle('hide-section', !cb.checked);
        }

        function changeLang(l) {
            params.set('lang', l);
            window.location.search = params.toString();
        }

        window.onload = () => {
            if(!produitId) return;
            loadScript("config.js", () => {
                loadScript(`${dossier}/${produitId}.js`, () => {
                    if (window.PRODUCT_DATA && window.GLOBAL_CONFIG) renderPage(window.PRODUCT_DATA, window.GLOBAL_CONFIG);
                });
            });
        };

        function loadScript(src, cb) {
            const s = document.createElement('script');
            s.src = src + "?v=" + new Date().getTime();
            s.onload = cb;
            document.head.appendChild(s);
        }

        function renderPage(pc, gc) {
            const ui = UI_STRINGS[currentLang];
            document.getElementById('txt-showroom').innerText = ui.showroom;
            document.getElementById('txt-print').innerText = ui.print;
            document.getElementById('ui-titre').innerText = pc.nom[currentLang];
            document.getElementById('ui-brand').innerText = gc.brand.nom;
            document.getElementById('ui-logo').src = gc.brand.logo;
            document.getElementById('ui-main-img').src = `${dossier}/images/${pc.image_principale}`;
            document.getElementById('txt-fixation').innerText = ui.fixation;
            document.getElementById('val-vesa').innerText = pc.vesa || "N/A";
            document.getElementById('val-diag').innerText = pc.diagonale + '"';
            
            // Affichage de la carte
            const card = document.getElementById('main-card');
            card.style.display = 'block';
            setTimeout(() => card.style.opacity = "1", 50);

            // Injection des textes spécifiques (Inclus, Expert, etc.)
            document.getElementById('txt-inclus-title').innerText = ui.inclus;
            document.getElementById('txt-options-title').innerText = ui.options;
            document.getElementById('txt-expert-title').innerText = ui.expert;
            document.getElementById('txt-entretien-title').innerText = ui.entretien;

            lucide.createIcons(); // Toujours à la fin
        }
    </script>
</body>
</html>
