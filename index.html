<script>
    // ============================================================
    // CATALOGUE VERTEX : AJOUTE TES PRODUITS ET SECTIONS ICI
    // ============================================================
    const CATALOGUE = [
        {
            titre: "Double Face 55\"",
            categorie: "Vitrines", // Créera automatiquement un filtre "Vitrines"
            image: "images/VITRINE55.jpg",
            lien: "double-face.html",
            desc: "Luminosité 3500 nits. Idéal pour une visibilité maximale en plein soleil."
        },
        {
            titre: "Totem Outdoor 65\"",
            categorie: "Smart City", // Créera automatiquement un filtre "Smart City"
            image: "images/TOTEM65.jpg",
            lien: "totem-65.html",
            desc: "Résistance climatique IP65. Solution interactive pour espaces publics."
        },
        {
            titre: "LED Wall P1.5",
            categorie: "Écrans LED", // Ajoute une catégorie simplement en changeant ce mot
            image: "images/LEDWALL.jpg",
            lien: "led-wall.html",
            desc: "Affichage seamless haute définition. Contraste infini."
        },
        // Pour ajouter un nouveau produit, copie-colle un bloc { ... } ci-dessus.
    ];

    // ============================================================
    // LOGIQUE AUTONOME (NE PAS TOUCHER SAUF BESOIN TECHNIQUE)
    // ============================================================
    let categorieActive = 'all';

    function initShowroom() {
        genererInterface();
        filtrerCatalogue();
    }

    // Crée les boutons de filtres dynamiquement selon les catégories présentes dans CATALOGUE
    function genererInterface() {
        const filtresContainer = document.getElementById('filter-container');
        const categoriesUniques = ['all', ...new Set(CATALOGUE.map(p => p.categorie))];

        filtresContainer.innerHTML = categoriesUniques.map(cat => `
            <button class="filter-btn ${cat === 'all' ? 'active' : ''}" 
                    onclick="setFilter('${cat}', this)">
                ${cat === 'all' ? 'Toutes les solutions' : cat}
            </button>
        `).join('');
    }

    function setFilter(cat, btn) {
        categorieActive = cat;
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        filtrerCatalogue();
    }

    function filtrerCatalogue() {
        const recherche = document.getElementById('search-bar').value.toLowerCase();
        const badge = document.getElementById('product-count');
        
        // Logique de filtrage croisée (Recherche + Catégorie)
        const resultats = CATALOGUE.filter(p => {
            const matchTexte = p.titre.toLowerCase().includes(recherche) || p.desc.toLowerCase().includes(recherche);
            const matchCat = categorieActive === 'all' || p.categorie === categorieActive;
            return matchTexte && matchCat;
        });

        // Mise à jour du compteur avec animation
        badge.classList.add('count-bump');
        setTimeout(() => badge.classList.remove('count-bump'), 300);
        badge.innerText = resultats.length > 1 ? `${resultats.length} Solutions Disponibles` : `${resultats.length} Solution Disponible`;
        if(resultats.length === 0) badge.innerText = "Aucun résultat";

        afficherCards(resultats);
    }

    function afficherCards(liste) {
        const container = document.getElementById('product-container');
        
        if (liste.length === 0) {
            container.innerHTML = `
                <div class="col-span-full text-center py-20 opacity-30 italic">
                    <i data-lucide="search-x" class="w-12 h-12 mx-auto mb-4"></i>
                    <p class="uppercase tracking-[0.3em] text-[10px]">Aucune technologie correspondante</p>
                </div>`;
            lucide.createIcons();
            return;
        }

        container.innerHTML = liste.map(p => `
            <div class="vertex-card rounded-[2.5rem] p-8 flex flex-col h-full animate-in fade-in zoom-in duration-500">
                <div class="h-52 mb-6 flex items-center justify-center bg-black/20 rounded-[1.5rem] p-6 border border-white/5 group">
                    <img src="${p.image}" class="max-h-full max-w-full object-contain transition-transform duration-500 group-hover:scale-110">
                </div>
                <div class="flex-grow">
                    <p class="text-[#FFD700] text-[9px] font-black uppercase tracking-widest mb-2">${p.categorie}</p>
                    <h3 class="text-2xl font-black uppercase italic mb-3 leading-tight">${p.titre}</h3>
                    <p class="text-slate-400 text-xs mb-8 leading-relaxed">${p.desc}</p>
                </div>
                <a href="${p.lien}" class="btn-gold text-center py-4 rounded-xl text-[10px] uppercase tracking-[0.2em] flex items-center justify-center gap-2">
                    Fiche Technique <i data-lucide="arrow-right" class="w-3 h-3"></i>
                </a>
            </div>
        `).join('');
        lucide.createIcons();
    }

    window.onload = initShowroom;
</script>
